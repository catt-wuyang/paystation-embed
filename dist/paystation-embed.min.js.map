{"version":3,"file":"paystation-embed.min.js","sources":["../src/helpers.js","../src/postmessage.js","../src/version.js","../src/lightbox.js","../src/childwindow.js","../src/exception.js","../src/device.js","../src/app.js","../src/main.js"],"sourcesContent":["function isEmpty(value) {\n  return value === null || value === undefined;\n}\n\nfunction uniq(list) {\n  return list.filter(function (x, i, a) {\n    return a.indexOf(x) == i;\n  });\n}\n\nfunction zipObject(props, values) {\n  let index = -1,\n    length = props ? props.length : 0,\n    result = {};\n\n  if (length && !values && !Array.isArray(props[0])) {\n    values = [];\n  }\n  while (++index < length) {\n    const key = props[index];\n    if (values) {\n      result[key] = values[index];\n    } else if (key) {\n      result[key[0]] = key[1];\n    }\n  }\n  return result;\n}\n\nfunction param(a) {\n  const s = [];\n\n  const add = function (k, v) {\n    v = typeof v === \"function\" ? v() : v;\n    v = v === null ? \"\" : v === undefined ? \"\" : v;\n    s[s.length] = encodeURIComponent(k) + \"=\" + encodeURIComponent(v);\n  };\n\n  const buildParams = function (prefix, obj) {\n    let i, len, key;\n\n    if (prefix) {\n      if (Array.isArray(obj)) {\n        for (i = 0, len = obj.length; i < len; i++) {\n          buildParams(\n            prefix +\n              \"[\" +\n              (typeof obj[i] === \"object\" && obj[i] ? i : \"\") +\n              \"]\",\n            obj[i]\n          );\n        }\n      } else if (String(obj) === \"[object Object]\") {\n        for (key in obj) {\n          buildParams(prefix + \"[\" + key + \"]\", obj[key]);\n        }\n      } else {\n        add(prefix, obj);\n      }\n    } else if (Array.isArray(obj)) {\n      for (i = 0, len = obj.length; i < len; i++) {\n        add(obj[i].name, obj[i].value);\n      }\n    } else {\n      for (key in obj) {\n        buildParams(key, obj[key]);\n      }\n    }\n    return s;\n  };\n\n  return buildParams(\"\", a).join(\"&\");\n}\n\nfunction once(f) {\n  return function () {\n    f(arguments);\n    f = function () {};\n  };\n}\n\nfunction addEventObject(context, wrapEventInNamespace) {\n  const dummyWrapper = function (event) {\n    return event;\n  };\n  wrapEventInNamespace = wrapEventInNamespace || dummyWrapper;\n  let eventsList = [];\n\n  function isStringContainedSpace(str) {\n    return / /.test(str);\n  }\n\n  return {\n    trigger: function (eventName, data) {\n      const eventInNamespace = wrapEventInNamespace(eventName);\n      try {\n        const event = new CustomEvent(eventInNamespace, { detail: data }); // Not working in IE\n      } catch (e) {\n        const event = document.createEvent(\"CustomEvent\");\n        event.initCustomEvent(eventInNamespace, true, true, data);\n      }\n      document.dispatchEvent(event);\n    }.bind(context),\n    on: function (eventName, handle, options) {\n      function addEvent(eventName, handle, options) {\n        const eventInNamespace = wrapEventInNamespace(eventName);\n        document.addEventListener(eventInNamespace, handle, options);\n        eventsList.push({\n          name: eventInNamespace,\n          handle: handle,\n          options: options,\n        });\n      }\n\n      if (isStringContainedSpace(eventName)) {\n        const events = eventName.split(\" \");\n        events.forEach(function (parsedEventName) {\n          addEvent(parsedEventName, handle, options);\n        });\n      } else {\n        addEvent(eventName, handle, options);\n      }\n    }.bind(context),\n\n    off: function (eventName, handle, options) {\n      const offAllEvents = !eventName && !handle && !options;\n\n      if (offAllEvents) {\n        eventsList.forEach(function (event) {\n          document.removeEventListener(event.name, event.handle, event.options);\n        });\n        return;\n      }\n\n      function removeEvent(eventName, handle, options) {\n        const eventInNamespace = wrapEventInNamespace(eventName);\n        document.removeEventListener(eventInNamespace, handle, options);\n        eventsList = eventsList.filter(function (event) {\n          return event.name !== eventInNamespace;\n        });\n      }\n\n      if (isStringContainedSpace(eventName)) {\n        const events = eventName.split(\" \");\n        events.forEach(function (parsedEventName) {\n          removeEvent(parsedEventName, handle, options);\n        });\n      } else {\n        removeEvent(eventName, handle, options);\n      }\n    }.bind(context),\n  };\n}\n\nexport { addEventObject, isEmpty, uniq, zipObject, param, once };\n","import * as Helpers from \"./helpers\";\n\nfunction wrapEventInNamespace(eventName) {\n  return PostMessage._NAMESPACE + \"_\" + eventName;\n}\n\nfunction PostMessage(window) {\n  this.eventObject = Helpers.addEventObject(this, wrapEventInNamespace);\n  this.linkedWindow = window;\n\n  window.addEventListener &&\n    window.addEventListener(\n      \"message\",\n      function (event) {\n        if (event.source !== this.linkedWindow) {\n          return;\n        }\n\n        const message = {};\n        if (typeof event.data === \"string\" && JSON !== undefined) {\n          try {\n            message = JSON.parse(event.data);\n          } catch (e) {}\n        }\n\n        if (message.command) {\n          this.eventObject.trigger(message.command, message.data);\n        }\n      }.bind(this)\n    );\n}\n\n/** Private Members **/\nPostMessage.prototype.eventObject = null;\nPostMessage.prototype.linkedWindow = null;\n\n/** Public Members **/\nPostMessage.prototype.send = function (command, data, targetOrigin) {\n  if (data === undefined) {\n    data = {};\n  }\n\n  if (targetOrigin === undefined) {\n    targetOrigin = \"*\";\n  }\n\n  if (\n    !this.linkedWindow ||\n    this.linkedWindow.postMessage === undefined ||\n    window.JSON === undefined\n  ) {\n    return false;\n  }\n\n  try {\n    this.linkedWindow.postMessage(\n      JSON.stringify({ data: data, command: command }),\n      targetOrigin\n    );\n  } catch (e) {}\n\n  return true;\n};\n\nPostMessage.prototype.on = function (event, handle, options) {\n  this.eventObject.on(event, handle, options);\n};\n\nPostMessage.prototype.off = function (event, handle, options) {\n  this.eventObject.off(event, handle, options);\n};\n\nPostMessage._NAMESPACE = \"POST_MESSAGE\";\n\nexport default PostMessage;\n","export default \"1.2.8\";\n","// import \"./styles/lightBox.scss\";\n// import xsollaLogo from \"./spinners/xsolla.svg\";\n// import roundLogo from \"./spinners/round.svg\";\nimport * as Helpers from \"./helpers\";\nimport PostMessage from \"./postmessage\";\nimport version from \"./version\";\n\nfunction LightBox(isMobile) {\n  this.eventObject = Helpers.addEventObject(this, wrapEventInNamespace);\n  this.options = isMobile ? DEFAULT_OPTIONS_MOBILE : DEFAULT_OPTIONS;\n  this.message = null;\n}\n\nconst CLASS_PREFIX = \"xpaystation-widget-lightbox\";\nconst COMMON_OPTIONS = {\n  zIndex: 1000,\n  overlayOpacity: \".6\",\n  overlayBackground: \"#000000\",\n  contentBackground: \"#ffffff\",\n  closeByKeyboard: true,\n  closeByClick: true,\n  modal: false,\n  spinner: \"xsolla\",\n  spinnerColor: null,\n  spinnerUrl: null,\n  spinnerRotationPeriod: 0,\n};\nconst DEFAULT_OPTIONS = Object.assign({}, COMMON_OPTIONS, {\n  width: null,\n  height: \"100%\",\n  contentMargin: \"10px\",\n});\nconst DEFAULT_OPTIONS_MOBILE = Object.assign({}, COMMON_OPTIONS, {\n  width: \"100%\",\n  height: \"100%\",\n  contentMargin: \"0px\",\n});\n\nconst SPINNERS = {\n  //   xsolla: xsollaLogo,\n  //   round: roundLogo,\n  xsolla: \"\",\n  round: \"\",\n  none: \"\",\n};\n\nconst MIN_PS_DIMENSIONS = {\n  height: 500,\n  width: 600,\n};\n\nconst handleKeyupEventName = wrapEventInNamespace(\"keyup\");\nconst handleResizeEventName = wrapEventInNamespace(\"resize\");\n\nconst handleGlobalKeyup = function (event) {\n  const clickEvent = document.createEvent(\"Event\");\n  clickEvent.initEvent(handleKeyupEventName, false, true);\n  clickEvent.sourceEvent = event;\n\n  document.body.dispatchEvent(clickEvent);\n};\n\nconst handleSpecificKeyup = function (event) {\n  if (event.sourceEvent.which == 27) {\n    this.closeFrame();\n  }\n};\n\nconst handleGlobalResize = function () {\n  const resizeEvent = document.createEvent(\"Event\");\n  resizeEvent.initEvent(handleResizeEventName, false, true);\n\n  window.dispatchEvent(resizeEvent);\n};\n\nfunction wrapEventInNamespace(eventName) {\n  return LightBox._NAMESPACE + \"_\" + eventName;\n}\n\n/** Private Members **/\nLightBox.prototype.triggerEvent = function () {\n  this.eventObject.trigger.apply(this.eventObject, arguments);\n};\n\nLightBox.prototype.measureScrollbar = function () {\n  // thx walsh: https://davidwalsh.name/detect-scrollbar-width\n  const scrollDiv = document.createElement(\"div\");\n  scrollDiv.classList.add(\"scrollbar-measure\");\n  scrollDiv.setAttribute(\n    \"style\",\n    \"position: absolute;\" +\n      \"top: -9999px\" +\n      \"width: 50px\" +\n      \"height: 50px\" +\n      \"overflow: scroll\"\n  );\n\n  document.body.appendChild(scrollDiv);\n\n  const scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\n  document.body.removeChild(scrollDiv);\n\n  return scrollbarWidth;\n};\n\n/** Public Members **/\nLightBox.prototype.openFrame = function (url, options) {\n  this.options = Object.assign({}, this.options, options);\n  const HandleBoundSpecificKeyup = handleSpecificKeyup.bind(this);\n  options = this.options;\n\n  const spinner =\n    options.spinner === \"custom\" && !!options.spinnerUrl\n      ? '<img class=\"spinner-custom\" src=\"' +\n        encodeURI(options.spinnerUrl) +\n        '\" />'\n      : SPINNERS[options.spinner] || Object.values(SPINNERS)[0];\n\n  const template = function (settings) {\n    const host = document.createElement(\"div\");\n    host.className = settings.prefix;\n\n    const overlay = document.createElement(\"div\");\n    overlay.className = settings.prefix + \"-overlay\";\n\n    const content = document.createElement(\"div\");\n    content.className =\n      settings.prefix + \"-content\" + \" \" + settings.prefix + \"-content__hidden\";\n\n    const iframe = document.createElement(\"iframe\");\n    iframe.className = settings.prefix + \"-content-iframe\";\n    iframe.src = settings.url;\n    iframe.frameBorder = \"0\";\n    iframe.allowFullscreen = true;\n\n    const spinner = document.createElement(\"div\");\n    spinner.className = settings.prefix + \"-spinner\";\n    spinner.innerHTML = settings.spinner;\n\n    content.appendChild(iframe);\n\n    host.appendChild(overlay);\n    host.appendChild(content);\n    host.appendChild(spinner);\n\n    return host;\n  };\n\n  const bodyElement = document.body;\n  const lightBoxElement = template({\n    prefix: CLASS_PREFIX,\n    url: url,\n    spinner: spinner,\n  });\n  const lightBoxOverlayElement = lightBoxElement.querySelector(\n    \".\" + CLASS_PREFIX + \"-overlay\"\n  );\n  const lightBoxContentElement = lightBoxElement.querySelector(\n    \".\" + CLASS_PREFIX + \"-content\"\n  );\n  const lightBoxIframeElement = lightBoxContentElement.querySelector(\n    \".\" + CLASS_PREFIX + \"-content-iframe\"\n  );\n  const lightBoxSpinnerElement = lightBoxElement.querySelector(\n    \".\" + CLASS_PREFIX + \"-spinner\"\n  );\n\n  const psDimensions = {\n    width: withDefaultPXUnit(MIN_PS_DIMENSIONS.width),\n    height: withDefaultPXUnit(MIN_PS_DIMENSIONS.height),\n  };\n\n  function withDefaultPXUnit(value) {\n    const isStringWithoutUnit =\n      typeof value === \"string\" &&\n      String(parseFloat(value)).length === value.length;\n    if (isStringWithoutUnit) {\n      return value + \"px\";\n    }\n    return typeof value === \"number\" ? value + \"px\" : value;\n  }\n\n  lightBoxElement.style.zIndex = options.zIndex;\n\n  lightBoxOverlayElement.style.opacity = options.overlayOpacity;\n  lightBoxOverlayElement.style.backgroundColor = options.overlayBackground;\n\n  lightBoxContentElement.style.backgroundColor = options.contentBackground;\n  lightBoxContentElement.style.margin = withDefaultPXUnit(\n    options.contentMargin\n  );\n  lightBoxContentElement.style.width = options.width\n    ? withDefaultPXUnit(options.width)\n    : \"auto\";\n  lightBoxContentElement.style.height = options.height\n    ? withDefaultPXUnit(options.height)\n    : \"auto\";\n\n  if (options.spinnerColor) {\n    lightBoxSpinnerElement.querySelector(\"path\").style.fill =\n      options.spinnerColor;\n  }\n\n  if (options.spinner === \"custom\") {\n    const spinnerCustom =\n      lightBoxSpinnerElement.querySelector(\".spinner-custom\");\n    spinnerCustom.style[\"-webkit-animation-duration\"] =\n      options.spinnerRotationPeriod + \"s;\";\n    spinnerCustom.style[\"animation-duration\"] =\n      options.spinnerRotationPeriod + \"s;\";\n  }\n\n  if (options.closeByClick) {\n    lightBoxOverlayElement.addEventListener(\n      \"click\",\n      function () {\n        this.closeFrame();\n      }.bind(this)\n    );\n  }\n\n  bodyElement.appendChild(lightBoxElement);\n\n  if (options.closeByKeyboard) {\n    bodyElement.addEventListener(\n      handleKeyupEventName,\n      HandleBoundSpecificKeyup\n    );\n\n    bodyElement.addEventListener(\"keyup\", handleGlobalKeyup, false);\n  }\n\n  const showContent = Helpers.once(\n    function () {\n      hideSpinner(options);\n      lightBoxContentElement.classList.remove(\n        CLASS_PREFIX + \"-content__hidden\"\n      );\n      this.triggerEvent(\"load\");\n    }.bind(this)\n  );\n\n  const lightBoxResize = function () {\n    const width = options.width ? options.width : psDimensions.width;\n    const height = options.height ? options.height : psDimensions.height;\n\n    lightBoxContentElement.style.left = \"0px\";\n    lightBoxContentElement.style.top = \"0px\";\n    lightBoxContentElement.style.borderRadius = \"8px\";\n    lightBoxContentElement.style.width = withDefaultPXUnit(width);\n    lightBoxContentElement.style.height = withDefaultPXUnit(height);\n\n    const containerWidth = lightBoxElement.clientWidth,\n      containerHeight = lightBoxElement.clientHeight;\n\n    const contentWidth = outerWidth(lightBoxContentElement),\n      contentHeight = outerHeight(lightBoxContentElement);\n\n    const horMargin = contentWidth - lightBoxContentElement.offsetWidth,\n      vertMargin = contentHeight - lightBoxContentElement.offsetHeight;\n\n    const horDiff = containerWidth - contentWidth,\n      vertDiff = containerHeight - contentHeight;\n\n    if (horDiff < 0) {\n      lightBoxContentElement.style.width = containerWidth - horMargin + \"px\";\n    } else {\n      lightBoxContentElement.style.left = Math.round(horDiff / 2) + \"px\";\n    }\n\n    if (vertDiff < 0) {\n      lightBoxContentElement.style.height = containerHeight - vertMargin + \"px\";\n    } else {\n      lightBoxContentElement.style.top = Math.round(vertDiff / 2) + \"px\";\n    }\n  };\n\n  if (options.width && options.height) {\n    lightBoxResize = Helpers.once(lightBoxResize.bind(this));\n  }\n\n  function outerWidth(el) {\n    const width = el.offsetWidth;\n    const style = getComputedStyle(el);\n\n    width += parseInt(style.marginLeft) + parseInt(style.marginRight);\n    return width;\n  }\n\n  function outerHeight(el) {\n    const height = el.offsetHeight;\n    const style = getComputedStyle(el);\n\n    height += parseInt(style.marginTop) + parseInt(style.marginBottom);\n    return height;\n  }\n\n  let bodyStyles;\n  const hideScrollbar = function () {\n    bodyStyles = Helpers.zipObject(\n      [\"overflow\", \"paddingRight\"].map(function (key) {\n        return [key, getComputedStyle(bodyElement)[key]];\n      })\n    );\n\n    const bodyPad = parseInt(\n      getComputedStyle(bodyElement)[\"paddingRight\"] || 0,\n      10\n    );\n    bodyElement.style.overflow = \"hidden\";\n    bodyElement.style.paddingRight = withDefaultPXUnit(\n      bodyPad + this.measureScrollbar()\n    );\n  }.bind(this);\n\n  const resetScrollbar = function () {\n    if (bodyStyles) {\n      Object.keys(bodyStyles).forEach(function (key) {\n        bodyElement.style[key] = bodyStyles[key];\n      });\n    }\n  };\n\n  const showSpinner = function () {\n    lightBoxSpinnerElement.style.display = \"block\";\n  };\n\n  const hideSpinner = function () {\n    lightBoxSpinnerElement.style.display = \"none\";\n  };\n\n  let loadTimer;\n  lightBoxIframeElement.addEventListener(\"load\", function handleLoad(event) {\n    const timeout = !(options.width && options.height)\n      ? options.resizeTimeout || 30000\n      : 1000; // 30000 if psDimensions will not arrive and custom timeout is not provided\n    loadTimer = setTimeout(function () {\n      lightBoxResize();\n      showContent();\n    }, timeout);\n    lightBoxIframeElement.removeEventListener(\"load\", handleLoad);\n  });\n\n  const iframeWindow =\n    lightBoxIframeElement.contentWindow || lightBoxIframeElement;\n\n  // Cross-window communication\n  this.message = new PostMessage(iframeWindow);\n  if (options.width && options.height) {\n    this.message.on(\"dimensions\", function () {\n      lightBoxResize();\n      showContent();\n    });\n  } else {\n    this.message.on(\"dimensions\", function (event) {\n      const data = event.detail;\n      if (data.dimensions) {\n        psDimensions = Helpers.zipObject(\n          [\"width\", \"height\"].map(function (dim) {\n            return [\n              dim,\n              Math.max(MIN_PS_DIMENSIONS[dim] || 0, data.dimensions[dim] || 0) +\n                \"px\",\n            ];\n          })\n        );\n\n        lightBoxResize();\n      }\n      showContent();\n    });\n  }\n  this.message.on(\n    \"widget-detection\",\n    function () {\n      this.message.send(\"widget-detected\", {\n        version: version,\n        lightBoxOptions: options,\n      });\n    }.bind(this)\n  );\n  this.message.on(\n    \"widget-close\",\n    function () {\n      this.closeFrame();\n    }.bind(this)\n  );\n  this.message.on(\n    \"close\",\n    function () {\n      this.closeFrame();\n    }.bind(this)\n  );\n  this.message.on(\n    \"status\",\n    function (event) {\n      this.triggerEvent(\"status\", event.detail);\n    }.bind(this)\n  );\n  this.message.on(\n    \"user-country\",\n    function (event) {\n      this.triggerEvent(\"user-country\", event.detail);\n    }.bind(this)\n  );\n\n  // Resize\n  window.addEventListener(handleResizeEventName, lightBoxResize);\n  window.addEventListener(\"resize\", handleGlobalResize);\n\n  // Clean up after close\n  const that = this;\n  this.on(\"close\", function handleClose(event) {\n    that.message.off();\n    bodyElement.removeEventListener(\n      handleKeyupEventName,\n      HandleBoundSpecificKeyup\n    );\n    bodyElement.removeEventListener(\"keyup\", handleGlobalKeyup);\n\n    window.removeEventListener(\"resize\", handleGlobalResize);\n\n    window.removeEventListener(handleResizeEventName, lightBoxResize);\n    lightBoxElement.parentNode.removeChild(lightBoxElement);\n    resetScrollbar();\n    that.off(\"close\", handleClose);\n  });\n\n  showSpinner();\n  hideScrollbar();\n  this.triggerEvent(\"open\");\n};\n\nLightBox.prototype.closeFrame = function () {\n  if (!this.options.modal) {\n    this.triggerEvent(\"close\");\n  }\n};\n\nLightBox.prototype.close = function () {\n  this.closeFrame();\n};\n\nLightBox.prototype.on = function () {\n  this.eventObject.on.apply(this.eventObject, arguments);\n};\n\nLightBox.prototype.off = function () {\n  this.eventObject.off.apply(this.eventObject, arguments);\n};\n\nLightBox.prototype.getPostMessage = function () {\n  return this.message;\n};\n\nLightBox._NAMESPACE = \".xpaystation-widget-lightbox\";\n\nexport default LightBox;\n","import version from \"./version\";\nimport * as Helpers from \"./helpers\";\nimport PostMessage from \"./postmessage\";\n\nfunction ChildWindow() {\n  this.eventObject = Helpers.addEventObject(this, wrapEventInNamespace);\n  this.message = null;\n}\n\nfunction wrapEventInNamespace(eventName) {\n  return ChildWindow._NAMESPACE + \"_\" + eventName;\n}\n\nconst DEFAULT_OPTIONS = {\n  target: \"_blank\",\n};\n\n/** Private Members **/\nChildWindow.prototype.eventObject = null;\nChildWindow.prototype.childWindow = null;\n\nChildWindow.prototype.triggerEvent = function (event, data) {\n  this.eventObject.trigger(event, data);\n};\n\n/** Public Members **/\nChildWindow.prototype.open = function (url, options) {\n  options = Object.assign({}, DEFAULT_OPTIONS, options);\n\n  if (this.childWindow && !this.childWindow.closed) {\n    this.childWindow.location.href = url;\n  }\n\n  const that = this;\n  const addHandlers = function () {\n    that.on(\"close\", function handleClose() {\n      if (timer) {\n        clearTimeout(timer);\n      }\n      if (that.childWindow) {\n        that.childWindow.close();\n      }\n\n      that.off(\"close\", handleClose);\n    });\n\n    // Cross-window communication\n    that.message = new PostMessage(that.childWindow);\n    that.message.on(\n      \"dimensions widget-detection\",\n      function handleWidgetDetection() {\n        that.triggerEvent(\"load\");\n        that.message.off(\"dimensions widget-detection\", handleWidgetDetection);\n      }\n    );\n    that.message.on(\"widget-detection\", function handleWidgetDetection() {\n      that.message.send(\"widget-detected\", {\n        version: version,\n        childWindowOptions: options,\n      });\n      that.message.off(\"widget-detection\", handleWidgetDetection);\n    });\n    that.message.on(\"status\", function (event) {\n      that.triggerEvent(\"status\", event.detail);\n    });\n    that.on(\"close\", function handleClose() {\n      that.message.off();\n      that.off(\"close\", handleClose);\n    });\n    that.message.on(\"user-country\", function (event) {\n      that.triggerEvent(\"user-country\", event.detail);\n    });\n  };\n\n  switch (options.target) {\n    case \"_self\":\n      this.childWindow = window;\n      addHandlers();\n      this.childWindow.location.href = url;\n      break;\n    case \"_parent\":\n      this.childWindow = window.parent;\n      addHandlers();\n      this.childWindow.location.href = url;\n      break;\n    case \"_blank\":\n    default:\n      this.childWindow = window.open(url);\n      this.childWindow.focus();\n      addHandlers();\n\n      const checkWindow = function () {\n        if (this.childWindow) {\n          if (this.childWindow.closed) {\n            this.triggerEvent(\"close\");\n          } else {\n            timer = setTimeout(checkWindow, 100);\n          }\n        }\n      }.bind(this);\n      const timer = setTimeout(checkWindow, 100);\n      break;\n  }\n\n  this.triggerEvent(\"open\");\n};\n\nChildWindow.prototype.close = function () {\n  this.triggerEvent(\"close\");\n};\n\nChildWindow.prototype.on = function (event, handler, options) {\n  if (typeof handler !== \"function\") {\n    return;\n  }\n\n  this.eventObject.on(event, handler, options);\n};\n\nChildWindow.prototype.off = function (event, handler, options) {\n  this.eventObject.off(event, handler, options);\n};\n\nChildWindow.prototype.getPostMessage = function () {\n  return this.message;\n};\n\nChildWindow._NAMESPACE = \"CHILD_WINDOW\";\n\nexport default ChildWindow;\n","export default function (message) {\n  this.message = message;\n  this.name = \"XsollaPayStationWidgetException\";\n  this.toString = function () {\n    return this.name + \": \" + this.message;\n  }.bind(this);\n}\n","// import Bowser from \"bowser\";\n// console.log(Bowser);\n// const browser = Bowser.getParser(window.navigator.userAgent);\n\nfunction Device() {}\n\nDevice.prototype.isMobile = function () {\n  return false;\n  //   return browser.mobile || browser.tablet;\n};\n\nexport default Device;\n","import * as Helpers from \"./helpers\";\nimport LightBox from \"./lightbox\";\nimport ChildWindow from \"./childwindow\";\nimport Exception from \"./exception\";\nimport Device from \"./device\";\n\nfunction ready(fn) {\n  if (document.readyState !== \"loading\") {\n    fn();\n  } else {\n    document.addEventListener(\"DOMContentLoaded\", fn);\n  }\n}\n\nfunction App() {\n  this.config = Object.assign({}, DEFAULT_CONFIG);\n  this.eventObject = Helpers.addEventObject(this);\n  this.isInitiated = false;\n  this.postMessage = null;\n  this.childWindow = null;\n}\n\nApp.eventTypes = {\n  INIT: \"init\",\n  OPEN: \"open\",\n  OPEN_WINDOW: \"open-window\",\n  OPEN_LIGHTBOX: \"open-lightbox\",\n  LOAD: \"load\",\n  CLOSE: \"close\",\n  CLOSE_WINDOW: \"close-window\",\n  CLOSE_LIGHTBOX: \"close-lightbox\",\n  STATUS: \"status\",\n  STATUS_INVOICE: \"status-invoice\",\n  STATUS_DELIVERING: \"status-delivering\",\n  STATUS_TROUBLED: \"status-troubled\",\n  STATUS_DONE: \"status-done\",\n  USER_COUNTRY: \"user-country\",\n};\n\nconst DEFAULT_CONFIG = {\n  access_token: null,\n  access_data: null,\n  sandbox: false,\n  lightbox: {},\n  childWindow: {},\n  host: \"secure.xsolla.com\",\n  iframeOnly: false,\n};\nconst SANDBOX_PAYSTATION_URL =\n  \"https://sandbox-secure.xsolla.com/paystation2/?\";\nconst EVENT_NAMESPACE = \".xpaystation-widget\";\nconst ATTR_PREFIX = \"data-xpaystation-widget-open\";\n\n/** Private Members **/\nApp.prototype.config = {};\nApp.prototype.isInitiated = false;\nApp.prototype.eventObject = Helpers.addEventObject(this);\n\nApp.prototype.getPaymentUrl = function () {\n  if (this.config.payment_url) {\n    return this.config.payment_url;\n  }\n\n  const query = {};\n  if (this.config.access_token) {\n    query.access_token = this.config.access_token;\n  } else {\n    query.access_data = JSON.stringify(this.config.access_data);\n  }\n\n  const urlWithoutQueryParams = this.config.sandbox\n    ? SANDBOX_PAYSTATION_URL\n    : \"https://\" + this.config.host + \"/paystation2/?\";\n  return urlWithoutQueryParams + Helpers.param(query);\n};\n\nApp.prototype.checkConfig = function () {\n  if (\n    Helpers.isEmpty(this.config.access_token) &&\n    Helpers.isEmpty(this.config.access_data) &&\n    Helpers.isEmpty(this.config.payment_url)\n  ) {\n    this.throwError(\"No access token or access data or payment URL given\");\n  }\n\n  if (\n    !Helpers.isEmpty(this.config.access_data) &&\n    typeof this.config.access_data !== \"object\"\n  ) {\n    this.throwError(\"Invalid access data format\");\n  }\n\n  if (Helpers.isEmpty(this.config.host)) {\n    this.throwError(\"Invalid host\");\n  }\n};\n\nApp.prototype.checkApp = function () {\n  if (this.isInitiated === undefined) {\n    this.throwError(\"Initialize widget before opening\");\n  }\n};\n\nApp.prototype.throwError = function (message) {\n  throw new Exception(message);\n};\n\nApp.prototype.triggerEvent = function (eventName, data) {\n  if (arguments.length === 1) {\n    [].forEach.call(\n      arguments,\n      function (eventName) {\n        const event = document.createEvent(\"HTMLEvents\");\n        event.initEvent(eventName, true, false);\n        document.dispatchEvent(event);\n      }.bind(this)\n    );\n  } else {\n    this.eventObject.trigger(eventName, data);\n  }\n};\n\nApp.prototype.triggerCustomEvent = function (eventName, data) {\n  try {\n    const event = new CustomEvent(eventName, { detail: data }); // Not working in IE\n  } catch (e) {\n    const event = document.createEvent(\"CustomEvent\");\n    event.initCustomEvent(eventName, true, true, data);\n  }\n  document.dispatchEvent(event);\n};\n\n/**\n * Initialize widget with options\n * @param options\n */\nApp.prototype.init = function (options) {\n  function initialize(options) {\n    this.isInitiated = true;\n    this.config = Object.assign({}, DEFAULT_CONFIG, options);\n\n    const bodyElement = document.body;\n    const clickEventName = \"click\" + EVENT_NAMESPACE;\n\n    const handleClickEvent = function (event) {\n      const targetElement = document.querySelector(\"[\" + ATTR_PREFIX + \"]\");\n      if (event.sourceEvent.target === targetElement) {\n        this.open.call(this, targetElement);\n      }\n    }.bind(this);\n\n    bodyElement.removeEventListener(clickEventName, handleClickEvent);\n\n    const clickEvent = document.createEvent(\"Event\");\n    clickEvent.initEvent(clickEventName, false, true);\n\n    bodyElement.addEventListener(\n      \"click\",\n      function (event) {\n        clickEvent.sourceEvent = event;\n        bodyElement.dispatchEvent(clickEvent);\n      }.bind(this),\n      false\n    );\n\n    bodyElement.addEventListener(clickEventName, handleClickEvent);\n    this.triggerEvent(App.eventTypes.INIT);\n  }\n  ready(initialize.bind(this, options));\n};\n\n/**\n * Open payment interface (PayStation)\n */\nApp.prototype.open = function () {\n  this.checkConfig();\n  this.checkApp();\n\n  const triggerSplitStatus = function (data) {\n    switch (((data || {}).paymentInfo || {}).status) {\n      case \"invoice\":\n        this.triggerEvent(App.eventTypes.STATUS_INVOICE, data);\n        break;\n      case \"delivering\":\n        this.triggerEvent(App.eventTypes.STATUS_DELIVERING, data);\n        break;\n      case \"troubled\":\n        this.triggerEvent(App.eventTypes.STATUS_TROUBLED, data);\n        break;\n      case \"done\":\n        this.triggerEvent(App.eventTypes.STATUS_DONE, data);\n        break;\n    }\n  }.bind(this);\n\n  const url = this.getPaymentUrl();\n  const that = this;\n\n  function handleStatus(event) {\n    const statusData = event.detail;\n    that.triggerEvent(App.eventTypes.STATUS, statusData);\n    triggerSplitStatus(statusData);\n  }\n\n  function handleUserLocale(event) {\n    const userCountry = {\n      user_country: event.detail.user_country,\n    };\n    that.triggerCustomEvent(App.eventTypes.USER_COUNTRY, userCountry);\n  }\n\n  this.postMessage = null;\n  if (new Device().isMobile() && !this.config.iframeOnly) {\n    const childWindow = new ChildWindow();\n    childWindow.on(\"open\", function handleOpen() {\n      that.postMessage = childWindow.getPostMessage();\n      that.triggerEvent(App.eventTypes.OPEN);\n      that.triggerEvent(App.eventTypes.OPEN_WINDOW);\n      childWindow.off(\"open\", handleOpen);\n    });\n    childWindow.on(\"load\", function handleLoad() {\n      that.triggerEvent(App.eventTypes.LOAD);\n      childWindow.off(\"load\", handleLoad);\n    });\n    childWindow.on(\"close\", function handleClose() {\n      that.triggerEvent(App.eventTypes.CLOSE);\n      that.triggerEvent(App.eventTypes.CLOSE_WINDOW);\n      childWindow.off(\"status\", handleStatus);\n      childWindow.off(App.eventTypes.USER_COUNTRY, handleUserLocale);\n      childWindow.off(\"close\", handleClose);\n    });\n    childWindow.on(\"status\", handleStatus);\n    childWindow.on(App.eventTypes.USER_COUNTRY, handleUserLocale);\n    childWindow.open(url, this.config.childWindow);\n    that.childWindow = childWindow;\n  } else {\n    const lightBox = new LightBox(\n      new Device().isMobile() && this.config.iframeOnly\n    );\n    lightBox.on(\"open\", function handleOpen() {\n      that.postMessage = lightBox.getPostMessage();\n      that.triggerEvent(App.eventTypes.OPEN);\n      that.triggerEvent(App.eventTypes.OPEN_LIGHTBOX);\n      lightBox.off(\"open\", handleOpen);\n    });\n    lightBox.on(\"load\", function handleLoad() {\n      that.triggerEvent(App.eventTypes.LOAD);\n      lightBox.off(\"load\", handleLoad);\n    });\n    lightBox.on(\"close\", function handleClose() {\n      that.triggerEvent(App.eventTypes.CLOSE);\n      that.triggerEvent(App.eventTypes.CLOSE_LIGHTBOX);\n      lightBox.off(\"status\", handleStatus);\n      lightBox.off(App.eventTypes.USER_COUNTRY, handleUserLocale);\n      lightBox.off(\"close\", handleClose);\n    });\n    lightBox.on(\"status\", handleStatus);\n    lightBox.on(App.eventTypes.USER_COUNTRY, handleUserLocale);\n    lightBox.openFrame(url, this.config.lightbox);\n    that.childWindow = lightBox;\n  }\n};\n\n/**\n * Close payment interface (PayStation)\n */\nApp.prototype.close = function () {\n  this.childWindow.close();\n};\n\n/**\n * Attach an event handler function for one or more events to the widget\n * @param event One or more space-separated event types (init, open, load, close, status, status-invoice, status-delivering, status-troubled, status-done)\n * @param handler A function to execute when the event is triggered\n */\nApp.prototype.on = function (event, handler, options) {\n  if (typeof handler !== \"function\") {\n    return;\n  }\n\n  const handlerDecorator = function (event) {\n    handler(event, event.detail);\n  };\n\n  this.eventObject.on(event, handlerDecorator, options);\n};\n\n/**\n * Remove an event handler\n * @param event One or more space-separated event types\n * @param handler A handler function previously attached for the event(s)\n */\nApp.prototype.off = function (event, handler, options) {\n  this.eventObject.off(event, handler, options);\n};\n\n/**\n * Send a message directly to PayStation\n * @param command\n * @param data\n */\nApp.prototype.sendMessage = function (command, data) {\n  if (this.postMessage) {\n    this.postMessage.send.apply(this.postMessage, arguments);\n  }\n};\n\n/**\n * Attach an event handler function for message event from PayStation\n * @param command\n * @param handler\n */\nApp.prototype.onMessage = function (command, handler) {\n  if (this.postMessage) {\n    this.postMessage.on.apply(this.postMessage, arguments);\n  }\n};\n\nexport default App;\n","import * as Helpers from \"./helpers\";\nimport App from \"./app\";\n\nlet instance;\n\nconst getInstance = function () {\n  if (!instance) {\n    instance = new App();\n  }\n  return instance;\n};\n\nconst widget = Object.assign(\n  Helpers.zipObject(\n    [\"init\", \"open\", \"close\", \"on\", \"off\", \"sendMessage\", \"onMessage\"].map(\n      function (methodName) {\n        const app = getInstance();\n        return [\n          methodName,\n          function () {\n            return app[methodName].apply(app, arguments);\n          },\n        ];\n      }\n    )\n  ),\n  {\n    eventTypes: App.eventTypes,\n  }\n);\n\nexport default widget;\n"],"names":["isEmpty","value","zipObject","props","values","index","length","result","Array","isArray","key","once","f","arguments","addEventObject","context","wrapEventInNamespace","event","eventsList","isStringContainedSpace","str","test","trigger","eventName","data","eventInNamespace","CustomEvent","detail","e","document","createEvent","initCustomEvent","dispatchEvent","bind","on","handle","options","addEvent","addEventListener","push","name","split","forEach","parsedEventName","off","removeEventListener","removeEvent","filter","PostMessage","_NAMESPACE","window","this","eventObject","Helpers.addEventObject","linkedWindow","source","message","undefined","JSON","parse","command","prototype","send","targetOrigin","postMessage","stringify","version","LightBox","isMobile","DEFAULT_OPTIONS_MOBILE","DEFAULT_OPTIONS","CLASS_PREFIX","COMMON_OPTIONS","zIndex","overlayOpacity","overlayBackground","contentBackground","closeByKeyboard","closeByClick","modal","spinner","spinnerColor","spinnerUrl","spinnerRotationPeriod","Object","assign","width","height","contentMargin","SPINNERS","xsolla","round","none","MIN_PS_DIMENSIONS","handleKeyupEventName","handleResizeEventName","handleGlobalKeyup","clickEvent","initEvent","sourceEvent","body","handleSpecificKeyup","which","closeFrame","handleGlobalResize","resizeEvent","ChildWindow","triggerEvent","apply","measureScrollbar","scrollDiv","createElement","classList","add","setAttribute","appendChild","scrollbarWidth","offsetWidth","clientWidth","removeChild","openFrame","url","HandleBoundSpecificKeyup","encodeURI","bodyElement","lightBoxElement","settings","host","className","prefix","overlay","content","iframe","src","frameBorder","allowFullscreen","innerHTML","template","lightBoxOverlayElement","querySelector","lightBoxContentElement","lightBoxIframeElement","lightBoxSpinnerElement","psDimensions","withDefaultPXUnit","String","parseFloat","style","opacity","backgroundColor","margin","fill","spinnerCustom","showContent","Helpers.once","hideSpinner","remove","lightBoxResize","left","top","borderRadius","containerWidth","containerHeight","clientHeight","contentWidth","el","getComputedStyle","parseInt","marginLeft","marginRight","outerWidth","contentHeight","offsetHeight","marginTop","marginBottom","outerHeight","horMargin","vertMargin","horDiff","vertDiff","Math","bodyStyles","hideScrollbar","Helpers.zipObject","map","bodyPad","overflow","paddingRight","display","handleLoad","timeout","resizeTimeout","setTimeout","iframeWindow","contentWindow","dimensions","dim","max","lightBoxOptions","that","handleClose","parentNode","keys","close","getPostMessage","target","Exception","toString","Device","App","config","DEFAULT_CONFIG","isInitiated","childWindow","open","closed","location","href","addHandlers","timer","clearTimeout","handleWidgetDetection","childWindowOptions","parent","focus","checkWindow","handler","eventTypes","INIT","OPEN","OPEN_WINDOW","OPEN_LIGHTBOX","LOAD","CLOSE","CLOSE_WINDOW","CLOSE_LIGHTBOX","STATUS","STATUS_INVOICE","STATUS_DELIVERING","STATUS_TROUBLED","STATUS_DONE","USER_COUNTRY","access_token","access_data","sandbox","lightbox","iframeOnly","instance","getPaymentUrl","payment_url","query","a","s","k","v","encodeURIComponent","buildParams","obj","i","len","join","Helpers.param","checkConfig","Helpers.isEmpty","throwError","checkApp","call","triggerCustomEvent","init","fn","clickEventName","handleClickEvent","targetElement","readyState","triggerSplitStatus","paymentInfo","status","handleStatus","statusData","handleUserLocale","userCountry","user_country","handleOpen","lightBox","sendMessage","onMessage","widget","methodName","app"],"mappings":"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"}